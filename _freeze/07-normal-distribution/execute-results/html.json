{
  "hash": "fb506ba7b66816de21b629a4d12bdae5",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"The Normal Distribution\"\n---\n\n\n\n\n## Introduction\n\nThe \"normal distribution\" is referred to frequently in statistics. It's a symmetrical, bell-shaped distribution of data. The Normal distribution is a cornerstone of statistics as many statistical methods are built around it. If it did not exist statisticians would have had to invent it.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Generate normal curve\nx <- seq(-4, 4, length.out = 1000)\ny <- dnorm(x)\n\nnormal_curve <- tibble(x = x, y = y)\n\nggplot(normal_curve, aes(x = x, y = y)) +\n  geom_line(colour = \"#3498db\", linewidth = 1.5) +\n  geom_area(alpha = 0.3, fill = \"#3498db\") +\n  labs(x = \"Standard deviations from mean\", y = \"Density\") +\n  scale_x_continuous(breaks = -4:4) +\n  theme_minimal(base_size = 14) +\n  annotate(\"text\", x = 0, y = 0.2, label = \"Mean (μ)\", size = 4)\n```\n\n::: {.cell-output-display}\n![The characteristic bell-shaped curve of the Normal distribution](07-normal-distribution_files/figure-html/fig-normal-curve-1.png){#fig-normal-curve width=768}\n:::\n:::\n\n\nIt is often the case that the histogram of a continuous variable will display the characteristic bell-shaped distribution of the Normal distribution. The height of women shows a Normal distribution; the box plot shows a symmetric distribution of values above and below the median line.\n\n## Parameters of the Normal Distribution\n\nThe Normal distribution is completely described by two population parameters **μ** and **σ**, where:\n\n- **μ** (mu) represents the **population mean** (the centre of the distribution)\n- **σ** (sigma) represents the **population standard deviation**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx_vals <- seq(-10, 20, length.out = 1000)\n\nparams_data <- tibble(\n  x = rep(x_vals, 3),\n  y = c(dnorm(x_vals, mean = 5, sd = 2),\n        dnorm(x_vals, mean = 5, sd = 4),\n        dnorm(x_vals, mean = 10, sd = 2)),\n  Distribution = rep(c(\"μ=5, σ=2\", \"μ=5, σ=4\", \"μ=10, σ=2\"), each = length(x_vals))\n)\n\nggplot(params_data, aes(x = x, y = y, colour = Distribution)) +\n  geom_line(linewidth = 1.2) +\n  scale_colour_manual(values = c(\"#3498db\", \"#e74c3c\", \"#27ae60\")) +\n  labs(x = \"Value\", y = \"Density\") +\n  theme_minimal(base_size = 14) +\n  theme(legend.position = \"top\")\n```\n\n::: {.cell-output-display}\n![Normal distributions with different means and standard deviations](07-normal-distribution_files/figure-html/fig-normal-params-1.png){#fig-normal-params width=960}\n:::\n:::\n\n\n## The 95% Reference Range\n\nOne property of the Normal distribution is that exactly **95% of the distribution** lies between:\n\n$$\\mu - 1.96\\sigma \\quad \\text{and} \\quad \\mu + 1.96\\sigma$$\n\nThis is called a **reference range**. In this example, it is the range in which 95% of the population lie.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- seq(-4, 4, length.out = 1000)\ny <- dnorm(x)\n\nnormal_95 <- tibble(x = x, y = y)\n\nggplot(normal_95, aes(x = x, y = y)) +\n  geom_line(colour = \"#2c3e50\", linewidth = 1) +\n  geom_area(data = filter(normal_95, x >= -1.96 & x <= 1.96),\n            fill = \"#3498db\", alpha = 0.5) +\n  geom_vline(xintercept = c(-1.96, 1.96), linetype = \"dashed\", colour = \"#e74c3c\") +\n  annotate(\"text\", x = 0, y = 0.15, label = \"95%\", size = 6, fontface = \"bold\") +\n  annotate(\"text\", x = -2.5, y = 0.05, label = \"2.5%\", size = 4) +\n  annotate(\"text\", x = 2.5, y = 0.05, label = \"2.5%\", size = 4) +\n  labs(x = \"Standard deviations from mean (μ ± 1.96σ)\", y = \"Density\") +\n  scale_x_continuous(breaks = c(-4, -1.96, 0, 1.96, 4),\n                     labels = c(\"-4\", \"-1.96\", \"0\", \"1.96\", \"4\")) +\n  theme_minimal(base_size = 14)\n```\n\n::: {.cell-output-display}\n![95% of values in a Normal distribution lie within 1.96 standard deviations of the mean](07-normal-distribution_files/figure-html/fig-95-rule-1.png){#fig-95-rule width=768}\n:::\n:::\n\n\n## Estimating from Sample Data\n\nIn practice the two parameters of the Normal distribution are estimated from the sample data: the **sample mean** ($\\bar{x}$) and the **sample standard deviation** (SD).\n\nIf a sample is taken from a Normal distribution, and provided that the sample is not too small, then approximately 95% of the sample will be covered by:\n\n$$\\bar{x} - 1.96 \\times SD \\quad \\text{and} \\quad \\bar{x} + 1.96 \\times SD$$\n\n### Example: Height of Women\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Example data\nmean_height <- 1.61  # metres\nsd_height <- 0.07    # metres\n\nlower_95 <- mean_height - 1.96 * sd_height\nupper_95 <- mean_height + 1.96 * sd_height\n```\n:::\n\n\nIn an example where the mean height ($\\bar{x}$) of women was 1.61 m and the standard deviation (SD) was 0.07 m (i.e. 7 cm):\n\nApproximately 95% of the sample will be covered in the range:\n\n- Lower: 1.61 - 1.96 × 0.07 = **1.47 m**\n- Upper: 1.61 + 1.96 × 0.07 = **1.75 m**\n\n## The Standard Error\n\nImagine another random sample of women was selected to investigate their height. The values in this second sample will vary from woman to woman and we would expect the mean value for this new group to be different but not too different from that obtained in the first sample.\n\nThe precision with which the sample mean is estimated can be measured by the standard deviation of the mean. This is called the **standard error** (SE):\n\n$$SE = \\frac{SD}{\\sqrt{n}}$$\n\n### Example: Standard Error of Height\n\n\n::: {#tbl-se-example .cell tbl-cap='Effect of sample size on standard error'}\n\n```{.r .cell-code}\nn_large <- 5628\nn_small <- 20\n\nse_large <- sd_height / sqrt(n_large)\nse_small <- sd_height / sqrt(n_small)\n\ntibble(\n  `Sample size (n)` = c(n_large, n_small),\n  `Standard deviation` = c(sd_height, sd_height),\n  `Standard error` = c(round(se_large, 4), round(se_small, 4))\n) |>\n  kable() |>\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> Sample size (n) </th>\n   <th style=\"text-align:right;\"> Standard deviation </th>\n   <th style=\"text-align:right;\"> Standard error </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 5628 </td>\n   <td style=\"text-align:right;\"> 0.07 </td>\n   <td style=\"text-align:right;\"> 0.0009 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:right;\"> 0.07 </td>\n   <td style=\"text-align:right;\"> 0.0157 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nIn the example of 5,628 women the standard error of the mean would be 0.07/√5628 = 0.07/75 = **0.0009 m**. Because the sample size is very large the standard error of the mean is very small.\n\nIf the sample size was smaller, say 20 women, the standard error of the mean would have been larger: **0.0156 m**.\n\n::: {.callout-important}\n## Key Point\nSample size does not influence the size of the sample standard deviation, it influences the **precision of the estimated parameters**.\n:::\n\n## Confidence Intervals\n\n**Confidence intervals** define the range of values within which the population mean μ is likely to lie. A 95% confidence interval for the population mean is defined by:\n\n$$\\bar{x} - 1.96 \\times SE \\quad \\text{and} \\quad \\bar{x} + 1.96 \\times SE$$\n\n### Example: 95% Confidence Interval for Height\n\nIn the case of height among the sample of 5,628 women:\n\n- SE = 0.0009 m\n- 95% CI = 1.61 ± (1.96 × 0.0009) = **(1.608 m to 1.612 m)**\n\nThe interpretation of the confidence interval is that **95% of intervals will contain the true population mean**. This is interpreted as a 95% chance that the population mean will be contained in the interval.\n\nThe interval in this example is very narrow due to the large sample size. If the sample size had been 20, the interval would have been wider at **(1.58 m to 1.64 m)**.\n\n## Skewed Distributions\n\nMany statistical tests require data to be Normally distributed. In practice distributions are sometimes not symmetric and can be skewed. Often they display a long right-hand tail (**positive skew**) or long left-hand skew (**negative skew**).\n\nSkewed distributions can be made approximately Normal by **transforming** the original data:\n\n- In the case of **positively skewed** data, taking the **log** of the data can transform the data into an approximate Normal distribution\n- In the case of **negatively skewed** data (long left tail), **squaring** the data may help\n\nIf data are not Normally distributed, then **non-parametric methods** which do not make assumptions that the data come from a Normal distribution may need to be used.\n\n### Example: Log Transformation of Tumour Volume\n\nA common example of positively skewed data in oncology is tumour volume measurements. The following figure shows the distribution of tumour volumes before and after log transformation:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(246)\n# Generate positively skewed tumor volume data (in cm³)\ntumor_volumes <- rlnorm(200, meanlog = 3, sdlog = 0.8)\n\ntransformation_data <- tibble(\n  original = tumor_volumes,\n  log_transformed = log(tumor_volumes)\n)\n\n# Create side-by-side histograms\np1 <- ggplot(transformation_data, aes(x = original)) +\n  geom_histogram(bins = 30, fill = \"#e74c3c\", colour = \"white\", alpha = 0.8) +\n  labs(title = \"Original data (positively skewed)\",\n       x = \"Tumour volume (cm³)\",\n       y = \"Frequency\") +\n  theme_minimal(base_size = 12) +\n  theme(plot.title = element_text(size = 11, face = \"bold\"))\n\np2 <- ggplot(transformation_data, aes(x = log_transformed)) +\n  geom_histogram(bins = 30, fill = \"#3498db\", colour = \"white\", alpha = 0.8) +\n  labs(title = \"Log-transformed data (approximately Normal)\",\n       x = \"Log(tumour volume)\",\n       y = \"Frequency\") +\n  theme_minimal(base_size = 12) +\n  theme(plot.title = element_text(size = 11, face = \"bold\"))\n\np1 + p2\n```\n\n::: {.cell-output-display}\n![Effect of log transformation on positively skewed tumour volume data](07-normal-distribution_files/figure-html/fig-transformation-1.png){#fig-transformation width=960}\n:::\n:::\n\n\nThe original tumour volume data (left panel) shows a clear positive skew with a long right tail. After log transformation (right panel), the data displays an approximately Normal, symmetric distribution. This transformation allows us to use statistical methods that assume Normality.\n\n::: {.callout-tip}\n## When to Transform Data\nConsider transforming data when:\n\n- The distribution is clearly skewed (not symmetric)\n- Outliers are present on one side\n- Statistical tests require Normality assumptions\n- The transformed data will be easier to interpret in context\n:::\n\n## The Central Limit Theorem\n\nThe distribution of sample means will be nearly Normally distributed (whatever the distribution of measurements among individuals). It will get closer to a Normal distribution as the sample size increases.\n\nThis feature of mean values comes from the **Central Limit Theorem** and is very useful in the analysis of proportions.\n\n::: {.callout-tip}\n## Practical Implication\nEven if the underlying data are not Normally distributed, the distribution of sample means will approach a Normal distribution as sample size increases. This is why many statistical tests work well even with non-Normal data, provided the sample size is large enough.\n:::\n\n## Summary\n\n| Concept | Description |\n|---------|-------------|\n| Normal distribution | Symmetric, bell-shaped distribution |\n| Population mean (μ) | Centre of the distribution |\n| Population SD (σ) | Spread of the distribution |\n| 95% reference range | μ ± 1.96σ contains 95% of population |\n| Standard error (SE) | SD/√n - precision of estimated mean |\n| 95% confidence interval | $\\bar{x}$ ± 1.96×SE - range likely to contain population mean |\n| Central Limit Theorem | Sample means are approximately Normal regardless of underlying distribution |\n",
    "supporting": [
      "07-normal-distribution_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}