{
  "hash": "252fb288f22629a527b58d8beea0bbb0",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Presenting Data\"\n---\n\n# Presenting Data {#sec-presenting-data}\n\n\n\n## Why Visualise Data?\n\nBefore any statistical analysis, we should **look at our data**.\n\nVisualisation helps us:\n\n- Identify the main features of the data\n- Detect **outliers** (extreme values)\n- Spot data entry errors\n- Choose appropriate statistical methods\n\n::: {.callout-warning}\n## What are Outliers?\n**Outliers** are extreme observations that are inconsistent with the rest of the data. They can distort statistical analyses and may indicate measurement errors or genuinely unusual cases.\n:::\n\n## Frequency Distribution Tables\n\nA **frequency count** is simply how many times each value occurs.\n\n### Simple Frequency Table\n\n\n::: {#tbl-brain-mets .cell tbl-cap='Number of brain metastases among renal cancer patients treated with cranial radiotherapy'}\n\n```{.r .cell-code}\nbrain_mets <- tibble(\n  `Number of Brain Metastases` = c(\"1\", \"2\", \"3 or more\", \"Total\"),\n  `Number of Patients (n)` = c(19, 4, 9, 32),\n  `Percent of Patients (%)` = c(59.4, 12.5, 28.1, 100)\n)\n\nkable(brain_mets, align = \"c\")\n```\n\n::: {.cell-output-display}\n\n\n| Number of Brain Metastases | Number of Patients (n) | Percent of Patients (%) |\n|:--------------------------:|:----------------------:|:-----------------------:|\n|             1              |           19           |          59.4           |\n|             2              |           4            |          12.5           |\n|         3 or more          |           9            |          28.1           |\n|           Total            |           32           |          100.0          |\n\n\n:::\n:::\n\n\nThe most frequent category is called the **mode**. Here, the mode is 1 metastasis (occurring in 19 patients).\n\n### Relative Frequencies\n\nPercentages can also be expressed as **proportions**:\n\n- 59.4% = 0.594\n- 12.5% = 0.125\n- 28.1% = 0.281\n\n### Grouped Frequency Tables\n\nWhen data have many possible values, we group them into **intervals** (e.g., age groups: 20-29, 30-39, 40-49, etc.).\n\n## Graphs for Numerical Data\n\n### Histograms\n\nA **histogram** shows the distribution of a continuous variable using bars.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Simulate height data (approximately normal)\nset.seed(42)\nheights <- tibble(height = rnorm(5682, mean = 1.61, sd = 0.07))\n\nggplot(heights, aes(x = height)) +\n  geom_histogram(binwidth = 0.05, fill = \"#3498db\", colour = \"white\", alpha = 0.8) +\n  labs(x = \"Height (m)\", y = \"Frequency (n)\") +\n  scale_x_continuous(breaks = seq(1.2, 2.0, 0.2)) +\n  theme_minimal() +\n  theme(\n    axis.title = element_text(size = 12),\n    axis.text = element_text(size = 10)\n  )\n```\n\n::: {.cell-output-display}\n![Histogram of the heights of 5,682 women aged 25-64](04-presenting-data_files/figure-html/fig-histogram-1.png){#fig-histogram width=768}\n:::\n:::\n\n\n**Key features of histograms:**\n\n- X-axis: values of the variable\n- Y-axis: frequency (count) or relative frequency (%)\n- Bar width: size of each group/interval\n- Shape reveals the distribution pattern\n\n### Understanding Distribution Shapes\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(123)\n\n# Create three different distributions\nneg_skew <- tibble(x = rbeta(1000, 8, 2) * 70 + 10, type = \"Negatively Skewed\\n(long tail to left)\")\nsymmetric <- tibble(x = rnorm(1000, 45, 10), type = \"Symmetric\\n(bell-shaped)\")\npos_skew <- tibble(x = rbeta(1000, 2, 8) * 70 + 10, type = \"Positively Skewed\\n(long tail to right)\")\n\nall_dist <- bind_rows(neg_skew, symmetric, pos_skew) %>%\n  mutate(type = factor(type, levels = c(\"Negatively Skewed\\n(long tail to left)\", \n                                         \"Symmetric\\n(bell-shaped)\", \n                                         \"Positively Skewed\\n(long tail to right)\")))\n\nggplot(all_dist, aes(x = x)) +\n  geom_histogram(bins = 20, fill = \"#3498db\", colour = \"white\", alpha = 0.8) +\n  facet_wrap(~type, scales = \"free_y\") +\n  labs(x = \"Variable\", y = \"Frequency\") +\n  theme_minimal() +\n  theme(\n    strip.text = element_text(size = 11, face = \"bold\"),\n    axis.title = element_text(size = 11)\n  )\n```\n\n::: {.cell-output-display}\n![Different distribution shapes: negatively skewed, symmetric (bell-shaped), and positively skewed](04-presenting-data_files/figure-html/fig-skewness-1.png){#fig-skewness width=960}\n:::\n:::\n\n\n::: {.callout-note}\n## The Normal Distribution\nA **symmetric, bell-shaped** histogram is characteristic of the **Normal distribution** â€“ a fundamental concept we will explore in detail later.\n:::\n\n### Dot Plots\n\n**Dot plots** show every individual data point.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\npsa_data <- tibble(\n  timepoint = rep(c(\"Initial\", \"Week 18\"), each = 41),\n  psa = c(\n    # Initial PSA - higher values, more spread\n    c(runif(25, 6, 15), runif(10, 15, 22), runif(6, 22, 30)),\n    # Week 18 PSA - lower values, clustered\n    c(runif(35, 0, 4), runif(6, 4, 6))\n  )\n) %>%\n  mutate(timepoint = factor(timepoint, levels = c(\"Initial\", \"Week 18\")))\n\nggplot(psa_data, aes(x = timepoint, y = psa)) +\n  geom_jitter(width = 0.1, size = 2.5, colour = \"#2c3e50\", alpha = 0.7) +\n  labs(x = \"\", y = \"PSA (ng/mL)\") +\n  theme_minimal() +\n  theme(\n    axis.title = element_text(size = 12),\n    axis.text = element_text(size = 11)\n  )\n```\n\n::: {.cell-output-display}\n![PSA levels before treatment and at week 18 among 41 men who received SABR for prostate cancer](04-presenting-data_files/figure-html/fig-dotplot-1.png){#fig-dotplot width=672}\n:::\n:::\n\n\n**Advantages of dot plots:**\n\n- Shows all individual values\n- Reveals differences between groups clearly\n- Makes outliers visible\n\n### Box Plots\n\nA **box plot** (or box-and-whisker plot) shows five key statistics:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\nexample_data <- tibble(x = \"Data\", y = c(rnorm(95, 5, 1.5), 9.5, 10))\n\nggplot(example_data, aes(x = x, y = y)) +\n  geom_boxplot(fill = \"#3498db\", alpha = 0.6, width = 0.4, outlier.shape = 1, outlier.size = 3) +\n  # Annotations\n  annotate(\"text\", x = 1.35, y = 7.25, label = \"Upper Quartile (Q3)\\n75% below this line\", \n           hjust = 0, size = 3.5) +\n  annotate(\"segment\", x = 1.22, xend = 1.32, y = 6.5, yend = 6.5, colour = \"#2c3e50\") +\n  annotate(\"text\", x = 1.35, y = 5, label = \"Median (Q2)\\n50% below this line\", \n           hjust = 0, size = 3.5) +\n  annotate(\"segment\", x = 1.22, xend = 1.32, y = 5, yend = 5, colour = \"#2c3e50\") +\n  annotate(\"text\", x = 1.35, y = 3.5, label = \"Lower Quartile (Q1)\\n25% below this line\", \n           hjust = 0, size = 3.5) +\n  annotate(\"segment\", x = 1.22, xend = 1.32, y = 3.5, yend = 3.5, colour = \"#2c3e50\") +\n  annotate(\"text\", x = 1.35, y = 8.8, label = \"Maximum\\n(or upper whisker)\", hjust = 0, size = 3.5) +\n  annotate(\"text\", x = 1.35, y = 1.8, label = \"Minimum\\n(or lower whisker)\", hjust = 0, size = 3.5) +\n  annotate(\"text\", x = 0.6, y = 10, label = \"Outliers\", hjust = 1, size = 3.5) +\n  labs(x = \"\", y = \"Values\") +\n  theme_minimal() +\n  theme(axis.text.x = element_blank()) +\n  coord_cartesian(xlim = c(0.4, 2))\n```\n\n::: {.cell-output-display}\n![Anatomy of a box plot showing the five-number summary](04-presenting-data_files/figure-html/fig-boxplot-explained-1.png){#fig-boxplot-explained width=576}\n:::\n:::\n\n\n**The five-number summary:**\n\n| Statistic | Symbol | Description |\n|-----------|--------|-------------|\n| Minimum | | Smallest value (or lower whisker) |\n| Lower quartile | Q1 | 25% of data below this |\n| Median | Q2 | 50% of data below this |\n| Upper quartile | Q3 | 75% of data below this |\n| Maximum | | Largest value (or upper whisker) |\n\n**Clinical example:**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\nnlr_data <- tibble(\n  sex = rep(c(\"Women\", \"Men\"), c(60, 42)),\n  nlr = c(\n    c(rnorm(55, 3.2, 1.2), 6.5, 7.5, 8.5, 9.2, 10.5),  # Women with outliers\n    c(rnorm(38, 3.8, 1.0), 7.8, 8.2, 9.5, 11.2)  # Men with outliers\n  )\n)\n\nggplot(nlr_data, aes(x = sex, y = nlr)) +\n  geom_boxplot(fill = \"#3498db\", alpha = 0.6, width = 0.5, outlier.shape = 1, outlier.size = 2) +\n  labs(x = \"\", y = \"Neutrophil-Lymphocyte Ratio\") +\n  theme_minimal() +\n  theme(axis.title = element_text(size = 12))\n```\n\n::: {.cell-output-display}\n![Pre-treatment neutrophil-lymphocyte ratio in men and women who received SABR for lung cancer](04-presenting-data_files/figure-html/fig-boxplot-clinical-1.png){#fig-boxplot-clinical width=576}\n:::\n:::\n\n\n### Scatter Plots\n\n**Scatter plots** show the relationship between two numerical variables.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\n\n# Create correlated blood count data\nn <- 100\nneutrophils <- rnorm(n, 6, 2)\nwbc <- neutrophils + rnorm(n, 3, 1.5)  # Strong positive correlation\nplatelets <- rnorm(n, 250, 80)  # Weak correlation with WBC\n\nblood_data <- tibble(\n  neutrophils = pmax(neutrophils, 1),\n  wbc = pmax(wbc, 2),\n  platelets = pmax(platelets, 50)\n)\n\n# Add one outlier\nblood_data$wbc[50] <- 18\n\np1 <- ggplot(blood_data, aes(x = platelets, y = wbc)) +\n  geom_point(colour = \"#2c3e50\", alpha = 0.6, size = 2) +\n  labs(x = \"Platelets\", y = \"White Blood Cells\") +\n  theme_minimal()\n\np2 <- ggplot(blood_data, aes(x = neutrophils, y = wbc)) +\n  geom_point(colour = \"#2c3e50\", alpha = 0.6, size = 2) +\n  labs(x = \"Neutrophils\", y = \"White Blood Cells\") +\n  theme_minimal()\n\np1 + p2\n```\n\n::: {.cell-output-display}\n![Relationship between blood cell counts: platelets vs white blood cells (left) and neutrophils vs white blood cells (right)](04-presenting-data_files/figure-html/fig-scatterplot-1.png){#fig-scatterplot width=960}\n:::\n:::\n\n\nThe left plot shows a **weak positive association**. The right plot shows a **stronger positive association** (unsurprisingly, as white blood cells include neutrophils).\n\n## Graphs for Categorical Data\n\n### Bar Charts\n\n**Bar charts** display the frequency of categories.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstage_data <- tibble(\n  stage = factor(c(\"Ia\", \"Ib\", \"IIa\", \"IIb\", \"IIIa\", \"IIIb\"), \n                 levels = c(\"Ia\", \"Ib\", \"IIa\", \"IIb\", \"IIIa\", \"IIIb\")),\n  n = c(8, 5, 10, 6, 42, 22)\n)\n\nggplot(stage_data, aes(x = stage, y = n)) +\n  geom_col(fill = \"#3498db\", width = 0.7) +\n  labs(x = \"Clinical Stage\", y = \"Frequency\") +\n  theme_minimal() +\n  theme(axis.title = element_text(size = 12))\n```\n\n::: {.cell-output-display}\n![Clinical stage among 93 patients who received radical radiotherapy for non-small cell lung cancer](04-presenting-data_files/figure-html/fig-barchart-1.png){#fig-barchart width=672}\n:::\n:::\n\n\n**Key difference from histograms:**\n\n- Bar charts: **gaps between bars** (categorical data)\n- Histograms: **no gaps** (continuous data)\n\n### Pie Charts\n\n**Pie charts** show proportions of a whole.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlobe_data <- tibble(\n  lobe = c(\"Left Upper Lobe\", \"Left Lower Lobe\", \"Right Upper Lobe\", \n           \"Right Lower Lobe\", \"Right Middle Lobe\"),\n  n = c(35, 10, 28, 19, 1),\n  pct = round(n/sum(n) * 100, 0)\n) %>%\n  mutate(label = paste0(lobe, \"\\n(\", pct, \"%)\"))\n\n# Calculate label positions\nlobe_data <- lobe_data %>%\n  arrange(desc(lobe)) %>%\n  mutate(\n    cumsum = cumsum(n),\n    midpoint = cumsum - n/2,\n    pos = midpoint / sum(n) * 2 * pi\n  )\n\nggplot(lobe_data, aes(x = \"\", y = n, fill = lobe)) +\n  geom_bar(stat = \"identity\", width = 1, colour = \"white\") +\n  coord_polar(\"y\", start = 0) +\n  scale_fill_brewer(palette = \"Set2\") +\n  labs(fill = \"Tumour Location\") +\n  theme_void() +\n  theme(legend.position = \"right\",\n        legend.title = element_text(face = \"bold\"))\n```\n\n::: {.cell-output-display}\n![Tumour location among 93 patients who received radical radiotherapy for lung cancer](04-presenting-data_files/figure-html/fig-piechart-1.png){#fig-piechart width=672}\n:::\n:::\n\n\n::: {.callout-tip}\n## When to Use Pie Charts\nPie charts work best with 3-5 categories where you want to show parts of a whole. For more categories, bar charts are usually clearer.\n:::\n\n## Tables for Bivariate Categorical Data\n\n### Contingency Tables\n\nA **contingency table** (cross-tabulation) shows the relationship between two categorical variables.\n\n\n::: {#tbl-contingency .cell tbl-cap='Two-year follow-up status by sex among 102 patients following stereotactic radiotherapy for lung cancer'}\n\n```{.r .cell-code}\ncontingency <- tibble(\n  `Status at Two Years` = c(\"Alive\", \"Died\", \"Total\"),\n  `Women (n)` = c(\"48 (80%)\", \"12 (20%)\", \"60 (100%)\"),\n  `Men (n)` = c(\"29 (69%)\", \"13 (31%)\", \"42 (100%)\"),\n  `Total (n)` = c(\"77 (75%)\", \"25 (25%)\", \"102 (100%)\")\n)\n\nkable(contingency, align = \"c\")\n```\n\n::: {.cell-output-display}\n\n\n| Status at Two Years | Women (n) |  Men (n)  | Total (n)  |\n|:-------------------:|:---------:|:---------:|:----------:|\n|        Alive        | 48 (80%)  | 29 (69%)  |  77 (75%)  |\n|        Died         | 12 (20%)  | 13 (31%)  |  25 (25%)  |\n|        Total        | 60 (100%) | 42 (100%) | 102 (100%) |\n\n\n:::\n:::\n\n\n**Interpretation:**\n\n- 31% of men had died compared to only 20% of women\n- There is a suggestion of a possible association between sex and outcome\n\n::: {.callout-important}\n## Comparing Groups\nWhen groups have different sizes, always use **percentages** (relative frequencies) rather than raw counts for comparison.\n:::\n\n### Grouped Bar Charts\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\nps_data <- tibble(\n  sex = rep(c(\"Women\", \"Men\"), c(60, 42)),\n  ps = c(\n    sample(0:3, 60, replace = TRUE, prob = c(0.15, 0.40, 0.30, 0.15)),\n    sample(0:3, 42, replace = TRUE, prob = c(0.35, 0.30, 0.25, 0.10))\n  )\n) %>%\n  count(sex, ps) %>%\n  group_by(sex) %>%\n  mutate(pct = n / sum(n) * 100)\n\n# Three types of bar charts\np1 <- ggplot(ps_data, aes(x = factor(ps), y = n, fill = sex)) +\n  geom_col(position = \"dodge\", width = 0.7) +\n  scale_fill_manual(values = c(\"#e74c3c\", \"#3498db\")) +\n  labs(x = \"Performance Status\", y = \"Count\", fill = \"\", title = \"Clustered\") +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n\np2 <- ggplot(ps_data, aes(x = factor(ps), y = n, fill = sex)) +\n  geom_col(width = 0.7) +\n  scale_fill_manual(values = c(\"#e74c3c\", \"#3498db\")) +\n  labs(x = \"Performance Status\", y = \"Count\", fill = \"\", title = \"Stacked\") +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n\np3 <- ggplot(ps_data, aes(x = factor(ps), y = pct, fill = sex)) +\n  geom_col(width = 0.7) +\n  scale_fill_manual(values = c(\"#e74c3c\", \"#3498db\")) +\n  labs(x = \"Performance Status\", y = \"Percent (%)\", fill = \"\", title = \"100% Stacked\") +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n\np1 + p2 + p3 + plot_layout(guides = \"collect\") & theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![Distribution of performance status by sex among 102 NSCLC patients](04-presenting-data_files/figure-html/fig-grouped-bars-1.png){#fig-grouped-bars width=960}\n:::\n:::\n\n\nEach format has its uses:\n\n- **Clustered**: Compare actual counts across groups\n- **Stacked**: Show totals and composition\n- **100% Stacked**: Compare proportions when group sizes differ\n\n## Summary\n\n- Always **visualise data before analysis**\n- Choose the right graph for your data type:\n\n| Data Type | Recommended Graph |\n|-----------|-------------------|\n| Single numerical variable | Histogram, box plot |\n| Two numerical variables | Scatter plot |\n| Single categorical variable | Bar chart, pie chart |\n| Two categorical variables | Contingency table, grouped bar chart |\n\n- Look for patterns, outliers, and unexpected features\n- Use percentages when comparing groups of different sizes\n",
    "supporting": [
      "04-presenting-data_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}