{
  "hash": "0c920226d3884393759391f82f7f040d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Presenting Data\"\n---\n\n# Presenting Data {#sec-presenting-data}\n\n\n\n## Introduction\n\nThe use of graphics and descriptive statistics is an important step to identifying the main features of data, for detecting outliers, and identifying data which has been recorded incorrectly.\n\n**Outliers** are extreme observations which are not consistent with the rest of the data. The presence of outliers can distort statistical techniques.\n\n## Frequency Distribution Tables\n\nA count of the number of times something occurs is called a **frequency count**.\n\nWithin a data set we may list the data values and count how many times each value occurs. A table with the set of data values and frequency of each value is called a **frequency distribution table**.\n\n\n::: {#tbl-brain-mets .cell tbl-cap='Number of brain metastases among renal cancer patients treated with cranial radiotherapy'}\n\n```{.r .cell-code}\n# Create the brain metastases data\nbrain_mets <- tibble(\n  `Number of brain metastases` = c(\"1\", \"2\", \"3 or more\", \"Total\"),\n  `Number of patients (n)` = c(19, 4, 9, 32),\n  `Percent of patients (%)` = c(59.4, 12.5, 28.1, 100)\n)\n\nbrain_mets |>\n  kable() |>\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Number of brain metastases </th>\n   <th style=\"text-align:right;\"> Number of patients (n) </th>\n   <th style=\"text-align:right;\"> Percent of patients (%) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:right;\"> 19 </td>\n   <td style=\"text-align:right;\"> 59.4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 12.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 or more </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 28.1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Total </td>\n   <td style=\"text-align:right;\"> 32 </td>\n   <td style=\"text-align:right;\"> 100.0 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nThe most frequent category is called the **mode**. In the above table the mode would be 1 metastasis, which occurred in a total of 19 renal cancer patients.\n\nThe percentages in a frequency distribution table are sometimes expressed as **relative frequencies** or **proportions**. In the above table, the proportions would be 0.594, 0.125, 0.281.\n\n### Grouped Frequency Tables\n\nWhen the set of potential data values is large the data are organised in groups (examples – age groups 20-29, 30-39, 40-49, 50-59, 60-69 etc). A count of the number of data values in each group (group frequency) is made. The frequency distribution table will then include the data groupings and the frequency of each group.\n\n## Graphs for Numeric Data\n\n### Histograms\n\nA histogram consists of a set of rectangles which present the frequency distribution of a variable. It allows a visualisation of the shape of the data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create simple histogram anatomy diagram\nset.seed(100)\nsample_data <- tibble(x = c(2.5, 3.5, 4.5, 5.5, 6.5))\nsample_freq <- c(3, 7, 12, 8, 4)\n\nggplot() +\n  geom_col(aes(x = sample_data$x, y = sample_freq),\n           width = 0.9, fill = \"#3498db\", colour = \"#2980b9\", alpha = 0.7) +\n  # Y-axis label annotation\n  annotate(\"segment\", x = 1.5, xend = 1.5, y = 0, yend = 12,\n           arrow = arrow(length = unit(0.3, \"cm\"), ends = \"both\"), colour = \"#e74c3c\", linewidth = 1) +\n  annotate(\"text\", x = 0.8, y = 6, label = \"Frequency\\n(y-axis)\", colour = \"#e74c3c\", size = 3.5, fontface = \"bold\") +\n  # X-axis label annotation\n  annotate(\"segment\", x = 2, xend = 7, y = -1.5, yend = -1.5,\n           arrow = arrow(length = unit(0.3, \"cm\"), ends = \"both\"), colour = \"#27ae60\", linewidth = 1) +\n  annotate(\"text\", x = 4.5, y = -2.5, label = \"Variable values (x-axis)\", colour = \"#27ae60\", size = 3.5, fontface = \"bold\") +\n  # Bar width annotation\n  annotate(\"segment\", x = 4.05, xend = 4.95, y = 13, yend = 13,\n           arrow = arrow(length = unit(0.2, \"cm\"), ends = \"both\"), colour = \"#8e44ad\", linewidth = 0.8) +\n  annotate(\"text\", x = 4.5, y = 13.8, label = \"Group width\", colour = \"#8e44ad\", size = 3, fontface = \"bold\") +\n  # Midpoint annotation\n  annotate(\"point\", x = 4.5, y = 0, colour = \"#e67e22\", size = 3) +\n  annotate(\"segment\", x = 4.5, xend = 4.5, y = 0, yend = -0.8,\n           colour = \"#e67e22\", linewidth = 0.8, linetype = \"dashed\") +\n  annotate(\"text\", x = 5.8, y = 0.5, label = \"Midpoint\", colour = \"#e67e22\", size = 3, fontface = \"bold\") +\n  annotate(\"segment\", x = 5.3, xend = 4.6, y = 0.5, yend = 0.1,\n           arrow = arrow(length = unit(0.15, \"cm\")), colour = \"#e67e22\", linewidth = 0.6) +\n  labs(x = \"\", y = \"\") +\n  scale_y_continuous(limits = c(-3, 15), breaks = seq(0, 12, 3)) +\n  scale_x_continuous(limits = c(0.5, 8), breaks = sample_data$x) +\n  theme_minimal(base_size = 12) +\n  theme(panel.grid.minor = element_blank())\n```\n\n::: {.cell-output-display}\n![Anatomy of a histogram showing key components](04-presenting-data_files/figure-html/fig-histogram-anatomy-1.png){#fig-histogram-anatomy width=768}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Generate synthetic height data (women, approximately normal)\nset.seed(123)\nheights <- tibble(\n  height = rnorm(5682, mean = 1.61, sd = 0.07)\n)\n\nggplot(heights, aes(x = height)) +\n  geom_histogram(binwidth = 0.05, fill = \"#3498db\", colour = \"white\", alpha = 0.8) +\n  labs(x = \"Height (m)\", y = \"Frequency (n)\") +\n  scale_x_continuous(breaks = seq(1.2, 2.0, 0.2)) +\n  theme_minimal(base_size = 14)\n```\n\n::: {.cell-output-display}\n![Histogram of the heights of 5,682 women aged 25-64](04-presenting-data_files/figure-html/fig-histogram-1.png){#fig-histogram width=768}\n:::\n:::\n\n\nThe histogram above shows that the most frequent grouping of heights occurs at 1.6-1.65 m. There is a tendency for the bars of the histogram to cluster around this central modal group in a symmetric fashion. This is a classic example of a **Normal distribution** which displays a symmetric bell shape.\n\nNot all histograms are symmetric; **skewness** can exist in the distribution of values.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\n\n# Symmetric\nsymmetric <- tibble(x = rnorm(1000, 50, 10), type = \"Symmetric (bell shaped)\")\n\n# Positively skewed (long right tail)\npositive_skew <- tibble(x = rgamma(1000, shape = 2, scale = 10), type = \"Positively skewed\\n(long tail to the right)\")\n\n# Negatively skewed (long left tail)\nnegative_skew <- tibble(x = 100 - rgamma(1000, shape = 2, scale = 10), type = \"Negatively skewed\\n(long tail to the left)\")\n\nall_data <- bind_rows(symmetric, positive_skew, negative_skew)\nall_data$type <- factor(all_data$type, levels = c(\"Symmetric (bell shaped)\", \n                                                   \"Positively skewed\\n(long tail to the right)\",\n                                                   \"Negatively skewed\\n(long tail to the left)\"))\n\nggplot(all_data, aes(x = x)) +\n  geom_histogram(bins = 25, fill = \"#3498db\", colour = \"white\", alpha = 0.8) +\n  facet_wrap(~type, scales = \"free\") +\n  labs(x = \"Variable\", y = \"Frequency\") +\n  theme_minimal(base_size = 12)\n```\n\n::: {.cell-output-display}\n![Examples of symmetric, positively skewed, and negatively skewed distributions](04-presenting-data_files/figure-html/fig-skewness-1.png){#fig-skewness width=960}\n:::\n:::\n\n\n### Dot Plots\n\nDot plots are a simple method of conveying as much information as possible by showing all of the data. It retains individual subject values and clearly demonstrates differences between groups. An additional advantage is that outliers will be detected.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(456)\npsa_data <- tibble(\n  patient = rep(1:41, 2),\n  timepoint = rep(c(\"Initial\", \"Week 18\"), each = 41),\n  psa = c(\n    rlnorm(41, meanlog = 2, sdlog = 0.8),  # Initial - higher values\n    rlnorm(41, meanlog = 0.5, sdlog = 0.6)  # Week 18 - lower values\n  )\n)\n\npsa_data$timepoint <- factor(psa_data$timepoint, levels = c(\"Initial\", \"Week 18\"))\n\nggplot(psa_data, aes(x = timepoint, y = psa)) +\n  geom_jitter(width = 0.1, alpha = 0.7, colour = \"#2c3e50\", size = 2) +\n  labs(x = \"\", y = \"PSA (ng/mL)\") +\n  theme_minimal(base_size = 14)\n```\n\n::: {.cell-output-display}\n![PSA levels before treatment and at week 18 among men who received SABR for prostate cancer](04-presenting-data_files/figure-html/fig-dotplot-1.png){#fig-dotplot width=576}\n:::\n:::\n\n\n### Box Plots\n\nA boxplot is used for discrete and continuous data. It indicates 5 important statistics which describe the distribution of observations:\n\n1. **Minimum value**\n2. **Lower quartile (Q1)** - 25% of data values below this line\n3. **Median (Q2)** - 50% of data values below this line\n4. **Upper quartile (Q3)** - 75% of data values below this line\n5. **Maximum value**\n\nThe median is the middle observation in a set of data. 50% of the sample lie below, and 50% lie above the median. It can be seen from the figure that 50% of the data sample lie between the lower quartile (Q1) and the upper quartile (Q3).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(789)\nnlr_data <- tibble(\n  sex = rep(c(\"Women\", \"Men\"), c(50, 60)),\n  nlr = c(\n    rlnorm(50, meanlog = 1.0, sdlog = 0.5),\n    rlnorm(60, meanlog = 1.1, sdlog = 0.6)\n  )\n)\n\nggplot(nlr_data, aes(x = sex, y = nlr)) +\n  geom_boxplot(fill = \"#3498db\", alpha = 0.6, outlier.colour = \"#e74c3c\") +\n  labs(x = \"\", y = \"Neutrophil-lymphocyte ratio\") +\n  theme_minimal(base_size = 14)\n```\n\n::: {.cell-output-display}\n![Pre-treatment neutrophil-lymphocyte ratio in men and women who received SABR for lung cancer](04-presenting-data_files/figure-html/fig-boxplot-clinical-1.png){#fig-boxplot-clinical width=576}\n:::\n:::\n\n\n## Graphs for Bivariate Continuous Data\n\n### Scatterplots\n\nScatterplots show the relationship between two numeric variables measured on the same individuals. The values of one variable appear on the horizontal axis, and the values of the other variable appear on the vertical axis. Each individual in the data appears as a point in the plot.\n\nTwo variables are **positively associated** when higher values of one variable tend to accompany higher values of the other, and lower values tend to occur together.\n\nTwo variables are **negatively associated** when higher values of one variable tend to accompany lower values of the other.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(321)\nn <- 80\nblood_data <- tibble(\n  platelets = runif(n, 100, 450),\n  wbc = 5 + 0.015 * platelets + rnorm(n, 0, 2.5)\n)\n\nggplot(blood_data, aes(x = platelets, y = wbc)) +\n  geom_point(colour = \"#2c3e50\", alpha = 0.7, size = 2) +\n  labs(x = \"Platelets\", y = \"White blood cells\") +\n  theme_minimal(base_size = 14)\n```\n\n::: {.cell-output-display}\n![Scatterplot showing relationship between platelets and white blood cell counts](04-presenting-data_files/figure-html/fig-scatterplot-1.png){#fig-scatterplot width=768}\n:::\n:::\n\n\nThe scatterplot above shows a positive association between platelets and white blood cell counts. Here's another example showing the relationship between neutrophils and white blood cells:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(987)\nn <- 80\nneutrophil_data <- tibble(\n  neutrophils = runif(n, 2, 8),\n  wbc = 3 + 0.8 * neutrophils + rnorm(n, 0, 1.5)\n)\n\nggplot(neutrophil_data, aes(x = neutrophils, y = wbc)) +\n  geom_point(colour = \"#e74c3c\", alpha = 0.7, size = 2) +\n  geom_smooth(method = \"lm\", se = FALSE, colour = \"#2c3e50\", linetype = \"dashed\", linewidth = 0.8) +\n  labs(x = \"Neutrophils (10⁹/L)\", y = \"White blood cells (10⁹/L)\") +\n  theme_minimal(base_size = 14)\n```\n\n::: {.cell-output-display}\n![Scatterplot showing relationship between neutrophils and white blood cell counts](04-presenting-data_files/figure-html/fig-scatterplot-neutrophils-1.png){#fig-scatterplot-neutrophils width=768}\n:::\n:::\n\n\nThis scatterplot demonstrates a strong positive association - as neutrophil counts increase, white blood cell counts tend to increase as well. The dashed line shows the linear trend in the data.\n\n## Graphs for Categorical Data\n\n### Bar Charts\n\nBar charts are typically used for categorical data (but can be employed for discrete numerical data). Data can be nominal or ordinal.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create bar chart anatomy diagram\ncategory_data <- tibble(\n  category = factor(c(\"A\", \"B\", \"C\", \"D\"), levels = c(\"A\", \"B\", \"C\", \"D\")),\n  frequency = c(5, 12, 8, 15)\n)\n\nggplot(category_data, aes(x = category, y = frequency)) +\n  geom_col(fill = \"#3498db\", colour = \"#2980b9\", alpha = 0.7, width = 0.7) +\n  # Y-axis annotation\n  annotate(\"segment\", x = 0.3, xend = 0.3, y = 0, yend = 15,\n           arrow = arrow(length = unit(0.3, \"cm\"), ends = \"both\"), colour = \"#e74c3c\", linewidth = 1) +\n  annotate(\"text\", x = 0.1, y = 7.5, label = \"Frequency\\n(y-axis)\", colour = \"#e74c3c\", size = 3.5, fontface = \"bold\", hjust = 0.5) +\n  # X-axis annotation\n  annotate(\"segment\", x = 0.5, xend = 4.5, y = -2, yend = -2,\n           arrow = arrow(length = unit(0.3, \"cm\"), ends = \"both\"), colour = \"#27ae60\", linewidth = 1) +\n  annotate(\"text\", x = 2.5, y = -3.2, label = \"Categories (x-axis)\", colour = \"#27ae60\", size = 3.5, fontface = \"bold\") +\n  # Gap annotation\n  annotate(\"segment\", x = 1.35, xend = 1.65, y = 16.5, yend = 16.5,\n           arrow = arrow(length = unit(0.2, \"cm\"), ends = \"both\"), colour = \"#8e44ad\", linewidth = 0.8) +\n  annotate(\"text\", x = 1.5, y = 17.5, label = \"Gap between bars\\n(categorical data)\", colour = \"#8e44ad\", size = 3, fontface = \"bold\") +\n  # Bar label annotation\n  annotate(\"text\", x = 4, y = 15/2, label = \"Bar height =\\nfrequency\", colour = \"#e67e22\", size = 3, fontface = \"bold\") +\n  annotate(\"segment\", x = 3.5, xend = 4, y = 15/2, yend = 15,\n           arrow = arrow(length = unit(0.15, \"cm\")), colour = \"#e67e22\", linewidth = 0.6) +\n  annotate(\"segment\", x = 3.5, xend = 4, y = 15/2, yend = 0,\n           arrow = arrow(length = unit(0.15, \"cm\")), colour = \"#e67e22\", linewidth = 0.6) +\n  labs(x = \"\", y = \"\") +\n  scale_y_continuous(limits = c(-4, 19), breaks = seq(0, 15, 5)) +\n  theme_minimal(base_size = 12) +\n  theme(panel.grid.minor = element_blank())\n```\n\n::: {.cell-output-display}\n![Anatomy of a bar chart showing key components](04-presenting-data_files/figure-html/fig-barchart-anatomy-1.png){#fig-barchart-anatomy width=768}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstage_data <- tibble(\n  stage = factor(c(\"Ia\", \"Ib\", \"IIa\", \"IIb\", \"IIIa\", \"IIIb\"), \n                 levels = c(\"Ia\", \"Ib\", \"IIa\", \"IIb\", \"IIIa\", \"IIIb\")),\n  frequency = c(7, 4, 11, 5, 46, 20)\n)\n\nggplot(stage_data, aes(x = stage, y = frequency)) +\n  geom_col(fill = \"#3498db\", alpha = 0.8) +\n  labs(x = \"Clinical stage\", y = \"Frequency\") +\n  theme_minimal(base_size = 14)\n```\n\n::: {.cell-output-display}\n![Clinical stage among 93 radical radiotherapy NSCLC patients](04-presenting-data_files/figure-html/fig-barchart-1.png){#fig-barchart width=672}\n:::\n:::\n\n\n### Pie Charts\n\nPie charts illustrate nominal data. Each slice of the pie represents a category. The size of the slice is proportional to the relative frequency of that category. It is best utilised with 3-5 categories.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlocation_data <- tibble(\n  location = c(\"Left upper lobe\", \"Left lower lobe\", \"Right upper lobe\", \n               \"Right lower lobe\", \"Right middle lobe\"),\n  percent = c(38, 11, 30, 20, 1)\n)\n\nggplot(location_data, aes(x = \"\", y = percent, fill = location)) +\n  geom_col(width = 1) +\n  coord_polar(theta = \"y\") +\n  scale_fill_brewer(palette = \"Set2\") +\n  labs(fill = \"Tumour location\") +\n  theme_void(base_size = 12) +\n  theme(legend.position = \"right\")\n```\n\n::: {.cell-output-display}\n![Tumour location among 93 patients who received radical radiotherapy for lung cancer](04-presenting-data_files/figure-html/fig-piechart-1.png){#fig-piechart width=672}\n:::\n:::\n\n\n## Tables and Graphs for Bivariate Categorical Data\n\n### Contingency Tables\n\nWhen the interest is in the relationship between two qualitative variables a **contingency table** (a cross-tabulation) is created. This has the categories for one variable as rows and the categories of the other variable as columns. Each cell of the table has a count of the number of individuals in both categories.\n\nThe following example concerns the two-year follow-up of 42 men and 60 women following stereotactic radiotherapy for lung cancer. In total 25 patients had died and 77 were still alive at the two-year follow-up.\n\n\n::: {#tbl-contingency .cell tbl-cap='Cross-tabulation of status at two years by sex'}\n\n```{.r .cell-code}\ncontingency <- tibble(\n  `Status at two years` = c(\"Alive\", \"Died\", \"Total\"),\n  `Women (n)` = c(48, 12, 60),\n  `Men (n)` = c(29, 13, 42),\n  `Total (n)` = c(77, 25, 102)\n)\n\ncontingency |>\n  kable() |>\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Status at two years </th>\n   <th style=\"text-align:right;\"> Women (n) </th>\n   <th style=\"text-align:right;\"> Men (n) </th>\n   <th style=\"text-align:right;\"> Total (n) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Alive </td>\n   <td style=\"text-align:right;\"> 48 </td>\n   <td style=\"text-align:right;\"> 29 </td>\n   <td style=\"text-align:right;\"> 77 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Died </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 13 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Total </td>\n   <td style=\"text-align:right;\"> 60 </td>\n   <td style=\"text-align:right;\"> 42 </td>\n   <td style=\"text-align:right;\"> 102 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### Grouped Bar Charts\n\nGrouped bar charts are useful for displaying contingency table data visually.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngrouped_data <- tibble(\n  sex = rep(c(\"Women\", \"Men\"), each = 2),\n  status = rep(c(\"Alive\", \"Died\"), 2),\n  count = c(48, 12, 29, 13)\n)\n\nggplot(grouped_data, aes(x = sex, y = count, fill = status)) +\n  geom_col(position = \"dodge\", alpha = 0.8) +\n  scale_fill_manual(values = c(\"Alive\" = \"#27ae60\", \"Died\" = \"#e74c3c\")) +\n  labs(x = \"\", y = \"Number of patients\", fill = \"Status at 2 years\") +\n  theme_minimal(base_size = 14)\n```\n\n::: {.cell-output-display}\n![Status at two years by sex following stereotactic radiotherapy for lung cancer](04-presenting-data_files/figure-html/fig-grouped-bars-1.png){#fig-grouped-bars width=672}\n:::\n:::\n\n\n## Summary\n\n| Graph Type | Data Type | Purpose |\n|------------|-----------|---------|\n| Histogram | Continuous numeric | Show distribution shape |\n| Dot plot | Numeric | Show all individual values |\n| Box plot | Numeric | Show median, quartiles, range |\n| Scatter plot | Two numeric variables | Show relationship between variables |\n| Bar chart | Categorical | Show frequencies of categories |\n| Pie chart | Nominal (3-5 categories) | Show proportions |\n| Contingency table | Two categorical variables | Show joint frequencies |\n",
    "supporting": [
      "04-presenting-data_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}